# دليل توليد Templates الشهادات باستخدام AI للمطورين - Frontend Guide

## نظرة عامة

تم إضافة ميزة جديدة تسمح لـ ACC بتحميل صورة شهادة موجودة لديه، واستخدام AI (Google Gemini) لتحليل الصورة تلقائياً وإنشاء Template كامل. هذا الدليل يشرح للمطورين في Frontend كيفية تنفيذ هذه الميزة.

---

## ما هي الميزة الجديدة؟

بدلاً من أن يدخل ACC جميع إعدادات Template يدوياً (الألوان، الخطوط، المواضع، إلخ)، يمكنه الآن:

1. **رفع صورة شهادة** موجودة لديه
2. **اختيار الاتجاه** (Landscape أو Portrait)
3. **الضغط على زر "Generate"**
4. **AI يحلل الصورة** تلقائياً ويستخرج جميع التفاصيل
5. **Template جاهز للاستخدام** فوراً

---

## الفوائد للمستخدمين

### قبل الميزة الجديدة:
- يحتاج معرفة تقنية بكتابة HTML و CSS
- يستغرق وقتاً طويلاً لإنشاء Template
- يحتاج فهم بنية `template_config`
- قد تحدث أخطاء في الإعدادات

### بعد الميزة الجديدة:
- يحتاج فقط رفع صورة
- يستغرق ثوانٍ بدلاً من دقائق
- لا يحتاج معرفة تقنية
- دقة عالية في التحليل

---

## API Endpoint الجديد

### POST `/acc/certificate-templates/generate-from-image`

**الوصف**: رفع صورة شهادة وتحليلها باستخدام AI لإنشاء Template تلقائياً.

**نوع الطلب**: `multipart/form-data`

**المتطلبات:**
- `category_id`: معرف الفئة (مطلوب)
- `name`: اسم الـ Template (مطلوب)
- `certificate_image`: ملف صورة الشهادة (مطلوب)
- `orientation`: اتجاه الشهادة - `landscape` أو `portrait` (مطلوب)
- `status`: حالة الـ Template - `active` أو `inactive` (مطلوب)

**صيغ الصور المدعومة:**
- JPEG
- PNG
- JPG

**الحد الأقصى لحجم الملف:**
- 10 ميجابايت

---

## كيفية التنفيذ في Frontend

### الخطوة 1: إنشاء نموذج رفع الصورة

أنشئ نموذج يحتوي على:
- حقل لاختيار الصورة (File Input)
- قائمة منسدلة لاختيار الفئة (Category)
- حقل نصي لاسم الـ Template
- أزرار اختيار للاتجاه (Landscape/Portrait)
- قائمة منسدلة للحالة (Active/Inactive)
- زر "Generate Template"

### الخطوة 2: التحقق من البيانات

قبل الإرسال، تأكد من:
- تم اختيار صورة
- تم اختيار فئة
- تم إدخال اسم للـ Template
- تم اختيار اتجاه
- تم اختيار حالة

### الخطوة 3: إرسال الطلب

استخدم `FormData` لإرسال البيانات:
- أضف جميع الحقول إلى `FormData`
- أضف ملف الصورة
- أرسل الطلب إلى الـ endpoint
- أضف `Authorization` header مع Bearer token

### الخطوة 4: معالجة الاستجابة

عند نجاح الطلب:
- ستحصل على Template كامل في الاستجابة
- اعرض رسالة نجاح للمستخدم
- اعرض Template المُنشأ
- أتاح للمستخدم مراجعة Template قبل الحفظ

عند فشل الطلب:
- اعرض رسالة خطأ واضحة
- اشرح للمستخدم ما الخطأ
- أتاح له المحاولة مرة أخرى

---

## واجهة المستخدم المقترحة

### صفحة إنشاء Template

**القسم العلوي:**
- عنوان الصفحة: "Create Certificate Template"
- خياران: "Manual Creation" و "Generate from Image"

**عند اختيار "Generate from Image":**

**القسم الأول: رفع الصورة**
- عنوان: "Upload Certificate Image"
- حقل رفع ملف مع دعم السحب والإفلات
- رسالة: "Supported formats: JPEG, PNG, JPG (Max 10MB)"
- معاينة للصورة بعد الرفع

**القسم الثاني: إعدادات Template**
- حقل: "Template Name" (نص)
- قائمة منسدلة: "Category" (اختيار من القائمة)
- أزرار اختيار: "Orientation" (Landscape / Portrait)
- قائمة منسدلة: "Status" (Active / Inactive)

**القسم الثالث: معالجة AI**
- زر: "Generate Template with AI"
- مؤشر تحميل أثناء المعالجة
- رسالة: "Analyzing image... This may take a few seconds"

**القسم الرابع: النتيجة**
- عند النجاح:
  - رسالة نجاح
  - معاينة Template المُنشأ
  - زر "Save Template"
  - زر "Edit Template" (للتعديلات اليدوية)
  - زر "Try Again" (لرفع صورة أخرى)

- عند الفشل:
  - رسالة خطأ واضحة
  - اقتراحات للحل
  - زر "Try Again"

---

## حالات الاستخدام

### الحالة 1: رفع صورة Landscape

المستخدم:
1. يختار صورة شهادة أفقية
2. يختار "Landscape" في الاتجاه
3. يضغط "Generate"
4. يحصل على Template جاهز

### الحالة 2: رفع صورة Portrait

المستخدم:
1. يختار صورة شهادة عمودية
2. يختار "Portrait" في الاتجاه
3. يضغط "Generate"
4. يحصل على Template جاهز

### الحالة 3: تعديل Template بعد الإنشاء

المستخدم:
1. يرفع صورة ويولد Template
2. يراجع Template المُنشأ
3. يجد بعض الأخطاء في التحليل
4. يضغط "Edit Template"
5. يقوم بتعديل الإعدادات يدوياً
6. يحفظ Template المعدل

---

## رسائل المستخدم

### رسائل النجاح

**عند بدء المعالجة:**
- "Uploading image..."
- "Analyzing certificate design..."
- "Generating template..."

**عند اكتمال المعالجة:**
- "Template generated successfully!"
- "Your template is ready to use"
- "Review the template below before saving"

### رسائل الخطأ

**خطأ في الرفع:**
- "Failed to upload image. Please try again."
- "Image file is too large. Maximum size is 10MB."
- "Unsupported file format. Please use JPEG, PNG, or JPG."

**خطأ في التحليل:**
- "Failed to analyze image. Please try with a clearer image."
- "AI analysis failed. Please check your image quality and try again."
- "Could not generate template. Please ensure the image shows a clear certificate design."

**خطأ عام:**
- "Something went wrong. Please try again later."
- "Server error. Please contact support if the problem persists."

---

## أفضل الممارسات

### 1. تجربة المستخدم

**قبل الرفع:**
- اشرح للمستخدم ما يحتاج فعله
- اعرض أمثلة على صور جيدة
- اذكر المتطلبات (الحجم، الصيغة)

**أثناء المعالجة:**
- اعرض مؤشر تحميل واضح
- اشرح ما يحدث في كل مرحلة
- امنع المستخدم من إغلاق الصفحة أثناء المعالجة

**بعد المعالجة:**
- اعرض Template بوضوح
- أتاح للمستخدم مراجعة قبل الحفظ
- أتاح التعديلات اليدوية

### 2. التحقق من البيانات

**قبل الإرسال:**
- تحقق من وجود جميع الحقول المطلوبة
- تحقق من صحة نوع الملف
- تحقق من حجم الملف
- تحقق من صحة البيانات الأخرى

**بعد الاستجابة:**
- تحقق من وجود Template في الاستجابة
- تحقق من صحة البيانات المُرجعة
- اعرض رسائل خطأ واضحة عند الحاجة

### 3. معالجة الأخطاء

**أخطاء الشبكة:**
- اعرض رسالة واضحة
- أتاح إعادة المحاولة
- احفظ البيانات المدخلة لتجنب إعادة الإدخال

**أخطاء التحقق:**
- اعرض رسائل خطأ بجانب الحقول الخاطئة
- اشرح ما هو مطلوب
- أبرز الحقول المطلوبة

**أخطاء الخادم:**
- اعرض رسالة عامة
- أتاح التواصل مع الدعم
- سجل الخطأ للمطورين

---

## التصميم المقترح

### الألوان

**الأزرار:**
- زر "Generate": لون أساسي (Primary Color)
- زر "Save": لون نجاح (Success Color)
- زر "Cancel": لون محايد (Neutral Color)
- زر "Try Again": لون تحذير (Warning Color)

**الحالات:**
- حالة التحميل: لون معلومات (Info Color)
- حالة النجاح: لون نجاح (Success Color)
- حالة الخطأ: لون خطأ (Error Color)

### الأيقونات

**استخدم أيقونات واضحة:**
- أيقونة رفع ملف
- أيقونة تحميل
- أيقونة نجاح
- أيقونة خطأ
- أيقونة معاينة

### التخطيط

**استخدم تخطيط واضح:**
- قسم لكل خطوة
- مسافات مناسبة بين العناصر
- تدرج واضح في الخطوات
- معاينة كبيرة للصورة

---

## الاختبار

### حالات الاختبار المطلوبة

**رفع الصور:**
- رفع صورة Landscape صحيحة
- رفع صورة Portrait صحيحة
- رفع صورة بحجم كبير جداً
- رفع صورة بصيغة غير مدعومة
- رفع بدون اختيار صورة

**البيانات:**
- إرسال بدون فئة
- إرسال بدون اسم
- إرسال بدون اتجاه
- إرسال بدون حالة
- إرسال بجميع البيانات صحيحة

**الاستجابات:**
- معالجة استجابة نجاح
- معالجة استجابة خطأ
- معالجة استجابة فارغة
- معالجة استجابة غير صحيحة

**واجهة المستخدم:**
- عرض مؤشر التحميل
- إخفاء مؤشر التحميل بعد الانتهاء
- عرض رسائل النجاح
- عرض رسائل الخطأ
- تحديث الواجهة بعد الحفظ

---

## التكامل مع الميزات الأخرى

### بعد إنشاء Template

**الخيارات المتاحة:**
- معاينة Template (Preview)
- تعديل Template
- حذف Template
- تفعيل/تعطيل Template
- استخدام Template في توليد شهادات

### ربط مع Training Center

**بعد إنشاء Template:**
- Training Center يمكنه رؤية Template
- Training Center يمكنه استخدام Template
- Training Center يدخل المتغيرات فقط
- النظام يولد PDF تلقائياً

---

## ملاحظات مهمة

### للمستخدمين

**نصائح لصورة جيدة:**
- استخدم صور عالية الجودة
- تأكد من وضوح النصوص
- تجنب الصور المشوشة
- استخدم إضاءة جيدة

**بعد الإنشاء:**
- راجع Template دائماً قبل الاستخدام
- قم بتعديل أي أخطاء في التحليل
- اختبر Template قبل تفعيله
- استخدم Preview للتحقق

### للمطورين

**الأمان:**
- تحقق من صحة الملفات المرفوعة
- حدد حجم الملفات
- حدد أنواع الملفات
- تحقق من الصلاحيات

**الأداء:**
- اعرض مؤشر تحميل أثناء المعالجة
- استخدم معالجة غير متزامنة إذا أمكن
- احفظ البيانات مؤقتاً لتجنب فقدانها
- حدد وقت انتهاء للطلبات

---

## الأسئلة الشائعة

### للمستخدمين

**س: كم يستغرق تحليل الصورة؟**
ج: عادة ما يستغرق من 5 إلى 15 ثانية حسب جودة الصورة.

**س: هل يمكنني تعديل Template بعد الإنشاء؟**
ج: نعم، يمكنك تعديل أي عنصر في Template بعد الإنشاء.

**س: ماذا لو كانت الصورة غير واضحة؟**
ج: قد لا يكون التحليل دقيقاً. حاول استخدام صورة أوضح أو قم بالتعديلات اليدوية.

**س: هل يمكنني استخدام Template فوراً؟**
ج: نعم، بعد الإنشاء يمكن استخدام Template مباشرة.

### للمطورين

**س: ماذا لو فشل تحليل AI؟**
ج: اعرض رسالة خطأ واضحة وأتاح للمستخدم المحاولة مرة أخرى أو الإنشاء يدوياً.

**س: كيف أتعامل مع الملفات الكبيرة؟**
ج: حدد حجم الملف قبل الرفع واعرض رسالة خطأ إذا تجاوز الحد.

**س: كيف أتعامل مع انقطاع الاتصال؟**
ج: احفظ البيانات المدخلة محلياً وأتاح استئناف العملية بعد إعادة الاتصال.

---

## الخلاصة

### ما يجب على Frontend فعله

1. **إنشاء واجهة رفع صورة** مع التحقق من البيانات
2. **إرسال الطلب** إلى الـ endpoint الجديد
3. **معالجة الاستجابة** وعرض Template المُنشأ
4. **أتاح المراجعة والتعديل** قبل الحفظ
5. **معالجة الأخطاء** بشكل واضح ومفيد

### الفوائد

- **تجربة مستخدم أفضل**: أسهل وأسرع للمستخدمين
- **دقة عالية**: AI يحلل بدقة عالية
- **مرونة**: يمكن التعديل بعد الإنشاء
- **تكامل سلس**: يعمل مع النظام الحالي

---

**تاريخ الإنشاء**: 2026-01-12  
**الإصدار**: 1.0  
**الجمهور المستهدف**: Frontend Developers

